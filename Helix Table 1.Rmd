---
title: "Helix Table One"
author: "Leah Wood"
date: "2025-06-25"
output: pdf_document
---

```{r}
library(dplyr)
```

```{r}
#Read in the data
codebook<-read.csv("codebook.csv", header=T)
covariates<-read.csv("covariates.csv", header = T)
exposome<-read.csv("exposome.csv", header = T)
phenotype<-read.csv("phenotype.csv", header=T)
covariates<-covariates[,-1]
phenotype<-phenotype[,-1]
```

Table One for PFAS

```{r}
#First going to merge behavior with PFAS
PFAS_codebook<-codebook[c(160:169),]
PFAS<-exposome[,c(PFAS_codebook$variable_name)]
PFAS<-cbind(exposome$ID, PFAS)
PFAS<-rename(PFAS, ID = `exposome$ID`)
PFAS<-cbind(PFAS, phenotype$hs_Gen_Tot)
PFAS<-rename(PFAS, hs_Gen_Tot=`phenotype$hs_Gen_Tot`)
```

```{r}
#Now split the behavior
PFAS$behavior_concern<-vector(length=1301)
for (i in 1:1301) {
  score <- PFAS$hs_Gen_Tot[i]
  
  if (score < 60) {
    PFAS$behavior_concern[i] <- "Low"
  } else {
    PFAS$behavior_concern[i] <- "High"
  }
}
PFAS$behavior_concern<-as.factor(PFAS$behavior_concern)
PFAS$behavior_concern<-relevel(PFAS$behavior_concern, ref="Low")
```

```{r}
library(table1)
library(tableone)
```

```{r}
#Add Labels 
label(PFAS$hs_pfhxs_c_Log2)<- "PFHXS (C)"
label(PFAS$hs_pfhxs_m_Log2)<- "PFHXS (M)"
label(PFAS$hs_pfna_c_Log2)<- "PFNA (C)"
label(PFAS$hs_pfna_m_Log2)<- "PFNA (M)"
label(PFAS$hs_pfoa_c_Log2)<- "PFOA (C)"
label(PFAS$hs_pfoa_m_Log2)<- "PFOA (M)"
label(PFAS$hs_pfos_c_Log2)<- "PFOS (C)"
label(PFAS$hs_pfos_m_Log2)<- "PFOS (M)"
label(PFAS$hs_pfunda_c_Log2)<- "PFUNA (C)"
label(PFAS$hs_pfunda_m_Log2)<- "PFUNA (M)"
caption1<- "PFAS exposure (Log ng/mL) in Child Behavioral Categories"
footnote1<- "(C) = In Child / (M) = In Mother"
```

```{r}
table1(~hs_pfhxs_c_Log2+hs_pfhxs_m_Log2+hs_pfna_c_Log2+hs_pfna_m_Log2+hs_pfoa_c_Log2+hs_pfoa_m_Log2+hs_pfos_c_Log2+hs_pfos_m_Log2+hs_pfunda_c_Log2+hs_pfunda_m_Log2|behavior_concern,data=PFAS,overall=c(left="Total"), caption=caption1, footnote=footnote1)
```

```{r}
#check Assumptions
boxplot(hs_Gen_Tot~behavior_concern, data=PFAS)
hist(PFAS[PFAS$behavior_concern=="High",12])
hist(PFAS[PFAS$behavior_concern=="Low",12])
```

```{r}
#We will be going with a test that checks medians

pfas_vars <- names(PFAS)[2:11] 

pfas_pvals <- sapply(pfas_vars, function(var) {
  test <- wilcox.test(PFAS[[var]] ~ PFAS$behavior_concern)
  c(p.value = test$p.value, statistic = test$statistic)
})

# Convert to data frame for easier viewing
pfas_pvals <- as.data.frame(t(pfas_pvals))
pfas_pvals
```

